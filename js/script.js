window.onload=function(){$(".preloader").addClass("hidden"),$("body").addClass("unlock")},$("document").ready((function(){function e(){$(window).width()<992?$(".header .contacts__phone").appendTo(".header-left"):$(window).width()>992&&$(".header .contacts__phone").prependTo(".header__contacts")}$(window).resize((function(){e()})),e()}));const triggered_select=$(".block, .card__btn");let triggered_blocks=localStorage.getItem("triggered_blocks")?JSON.parse(localStorage.getItem("triggered_blocks")):[];function initBlocks(e){e.filter((function(e,t){if(-1!=triggered_blocks.indexOf($(t).data("slide")))return t})).each((function(){$(this).addClass("active"),$(this).find(".block__icon img").attr("src",$(this).find(".block__icon img").attr("src").replace(/\./g,"_active."))})),e.filter((function(e,t){if(-1==triggered_blocks.indexOf($(t).data("slide")))return t})).each((function(){$(this).removeClass("active"),$(this).find(".block__icon img").attr("src",$(this).find(".block__icon img").attr("src").replace(/_active/g,""))}));$(".submit-application-select__title > span").text($(".block.active").length)}triggered_select.click((function(){let e=$(this),t=e.data("slide");if(-1==$.inArray(t,triggered_blocks))triggered_blocks.push(t);else{if(0==e.hasClass("block"))return;triggered_blocks=$.grep(triggered_blocks,(function(e){return e!=t}))}localStorage.setItem("triggered_blocks",JSON.stringify(triggered_blocks)),initBlocks($(`.block[data-slide="${t}"]`))})),initBlocks($(".block")),$(".card").each((function(){let e=$(this).find(".gallery__image img"),t=e[Math.floor(Math.random()*e.length)].src;$(this).css("background-image",`url("${t}")`)}));let images=$(".gallery__image");function progressBar(){$(window).scrollTop(),$(window).height();let e=$(window).height(),t=$(document).height()-e,i=$(window).scrollTop()/t*100,o=$(".header__cover").height()/t*100;if(i<o){let e=(100-o+o-2*i)/100;if(e>.85)return;$(".header__cover").css("opacity",e)}}function throttle(e,t,i){let o=localStorage.getItem(`time-${i}`)?localStorage.getItem(`time-${i}`):void 0;return function(...r){null==o&&(o=$.now(),localStorage.setItem(`time-${i}`,o),e(...r)),$.now()-o>t?(o=$.now(),localStorage.setItem(`time-${i}`,o),e(...r)):getAlert_error(`Подождите еще ${(t/1e3-($.now()-o)/1e3).toFixed(0)} секунд!`)}}function getAlert_succ(e){Swal.fire({position:"top-end",icon:"success",title:e,padding:"2em",width:"100%",color:"#232122",background:"#EAEAEA",showConfirmButton:!1,timer:3500,toast:!0})}function getAlert_error(e){Swal.fire({position:"top-end",icon:"error",title:e,padding:"2em",width:"100%",color:"red",background:"#EAEAEA",showConfirmButton:!1,timer:3500,toast:!0})}images.mouseover((function(){let e=$(this),t=$(this).find("img").attr("src");e.parents(".card").css("background-image",`url("${t}")`)})),$("[data-fancybox]").fancybox({touch:!1}),$(window).scroll(progressBar),$('a[href^="#"]').on("click",(function(e){e.preventDefault();var t,i=$(this.hash);i.length&&(t=$(window).width()<768?120:220,$("html, body").animate({scrollTop:i.offset().top-t},400))})),$(window).on("touchmove",(function(){$('a[href^="#"]').data("clicked",!1)})),$(document).on("touchend",'a[href^="#"]',(function(e){$(this).data("clicked")&&(e.preventDefault(),$(this).data("clicked",!1))}));let owl_servcies=$(".owl-carousel--services").owlCarousel({slideSpeed:300,paginationSpeed:400,center:!0,stopOnHover:!0,autoplay:100,loop:!0,margin:50});$(".carousel-services__next").click((function(){owl_servcies.trigger("next.owl.carousel",[300])})),$(".carousel-services__prev").click((function(){owl_servcies.trigger("prev.owl.carousel",[300])})),$(".carousel-services-dot").click((function(e,t){$(".carousel-services-dots").hasClass("fixed")&&$("html, body").animate({scrollTop:$(`.card__btn[data-slide='${$(this).data("slide")}']`).parents(".card").offset().top},1e3)})),$(".card__btn").click((function(e){$(this).siblings(".card__title").text();$.fancybox.open({src:".submit-application",type:"inline",touch:!1,autoSize:!0})})),$(".submit-application-form").validate({rules:{phone:{required:!0},name:{required:!0}},messages:{phone:{required:"Введите номер телефона!"},name:{required:"Введите имя!"}},submitHandler:function(e){throttle((function(){let e=[];$(".block.active .block__title").each((function(){e.push($(this).text())})),$.ajax({url:"/php/submit-application.php",type:"post",data:{phone:$('.submit-application-form input[name="phone"]').val(),name:$('.submit-application-form input[name="name"]').val(),review:$('.submit-application-form textarea[name="review"').val(),selected:JSON.stringify(e)},success:function(e){getAlert_succ("Заявка успешно отправлена! Ожидайте ответа!")}})}),18e4,"submit-application")()}}),$.validator.addMethod("phone",(function(e,t){return this.optional(t)||/^\+?\d{1,4}?[-.\s]?\(?\d{1,3}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}$/.test(e)}),"Номер введен некорректно!"),sal();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByZWxvYWRlci5qcyIsImFkYXB0aXZlLmpzIiwic2VsZWN0ZWRCbG9ja3MuanMiLCJjYXJkcy5qcyIsImhlYWRlcl9ib3R0b20uanMiLCJoZWxwZWQuanMiLCJmYW5jeS1ib3guanMiLCJvd2wtY2Fyb3VzZWwuanMiLCJzdWJtaXQtYXBwbGljYXRpb24uanMiLCJzYWwuanMiXSwibmFtZXMiOlsid2luZG93Iiwib25sb2FkIiwiJCIsImFkZENsYXNzIiwicmVhZHkiLCJhZGFwdGl2ZSIsIndpZHRoIiwiYXBwZW5kVG8iLCJwcmVwZW5kVG8iLCJyZXNpemUiLCJ0cmlnZ2VyZWRfc2VsZWN0IiwidHJpZ2dlcmVkX2Jsb2NrcyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJpbml0QmxvY2tzIiwiZGF0YSIsImZpbHRlciIsImluZGV4IiwiaXRlbSIsImluZGV4T2YiLCJlYWNoIiwidGhpcyIsImZpbmQiLCJhdHRyIiwicmVwbGFjZSIsInJlbW92ZUNsYXNzIiwidGV4dCIsImxlbmd0aCIsImNsaWNrIiwidHJpZ2dlciIsImJsb2NrX2luZGV4IiwiaW5BcnJheSIsInB1c2giLCJoYXNDbGFzcyIsImdyZXAiLCJ2YWx1ZSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJjYXJkX19pbWFnZXMiLCJjYXJkX19pbWFnZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInNyYyIsImNzcyIsImltYWdlcyIsInByb2dyZXNzQmFyIiwic2Nyb2xsVG9wIiwiaGVpZ2h0Iiwid2luSCIsImJhc2VYIiwiZG9jdW1lbnQiLCJhIiwiYiIsIm9wYWNpdHkiLCJ0aHJvdHRsZSIsImZ1bmMiLCJzZWNvbmRzIiwibmFtZSIsInRpbWVyIiwidW5kZWZpbmVkIiwiYXJncyIsIm5vdyIsImdldEFsZXJ0X2Vycm9yIiwidG9GaXhlZCIsImdldEFsZXJ0X3N1Y2MiLCJTd2FsIiwiZmlyZSIsInBvc2l0aW9uIiwiaWNvbiIsInRpdGxlIiwicGFkZGluZyIsImNvbG9yIiwiYmFja2dyb3VuZCIsInNob3dDb25maXJtQnV0dG9uIiwidG9hc3QiLCJtb3VzZW92ZXIiLCJ0aGlzX2ltYWdlIiwidGhpc19zcmMiLCJwYXJlbnRzIiwiZmFuY3lib3giLCJ0b3VjaCIsInNjcm9sbCIsIm9uIiwidCIsInByZXZlbnREZWZhdWx0IiwiZSIsIm4iLCJoYXNoIiwiYW5pbWF0ZSIsIm9mZnNldCIsInRvcCIsIm93bF9zZXJ2Y2llcyIsIm93bENhcm91c2VsIiwic2xpZGVTcGVlZCIsInBhZ2luYXRpb25TcGVlZCIsImNlbnRlciIsInN0b3BPbkhvdmVyIiwiYXV0b3BsYXkiLCJsb29wIiwibWFyZ2luIiwiZG90Iiwic2libGluZ3MiLCJvcGVuIiwidHlwZSIsImF1dG9TaXplIiwidmFsaWRhdGUiLCJydWxlcyIsInBob25lIiwicmVxdWlyZWQiLCJtZXNzYWdlcyIsInN1Ym1pdEhhbmRsZXIiLCJmb3JtIiwiYWN0aXZhdGVkX2l0ZW1zIiwiYWpheCIsInVybCIsInZhbCIsInJldmlldyIsInNlbGVjdGVkIiwic3VjY2VzcyIsInZhbGlkYXRvciIsImFkZE1ldGhvZCIsImVsZW1lbnQiLCJvcHRpb25hbCIsInRlc3QiLCJzYWwiXSwibWFwcGluZ3MiOiJBQUFBQSxPQUFBQyxPQUFBLFdBQ0FDLEVBQUEsY0FBQUMsU0FBQSxVQUNBRCxFQUFBLFFBQUFDLFNBQUEsU0FDQSxFQ0hBRCxFQUFBLFlBQUFFLE9BQUEsV0FDQSxTQUFBQyxJQUNBSCxFQUFBRixRQUFBTSxRQUFBLElBQ0FKLEVBQUEsNEJBQUFLLFNBQUEsZ0JBQ0FMLEVBQUFGLFFBQUFNLFFBQUEsS0FDQUosRUFBQSw0QkFBQU0sVUFBQSxvQkFFQSxDQUVBTixFQUFBRixRQUFBUyxRQUFBLFdBQ0FKLEdBQ0EsSUFFQUEsR0FDQSxJQ2RBLE1BQUFLLGlCQUFBUixFQUFBLHNCQUNBLElBQUFTLGlCQUFBQyxhQUFBQyxRQUFBLG9CQUFBQyxLQUFBQyxNQUFBSCxhQUFBQyxRQUFBLHFCQUFBLEdBbUJBLFNBQUFHLFdBQUFDLEdBQ0FB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LFVBQUFDLFVBQUEsU0FBQSxTQUFBdEYsRUFBQXVGLEdBQ0EsT0FBQXJHLEtBQUFzRyxTQUFBRCxJQUFBLCtFQUFBRSxLQUFBekYsRUFDQSxHQUFBLDZCQ25FQTBGIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpe1xyXG4gICAgJCgnLnByZWxvYWRlcicpLmFkZENsYXNzKCdoaWRkZW4nKTtcclxuICAgICQoJ2JvZHknKS5hZGRDbGFzcygndW5sb2NrJyk7XHJcbiAgfTsiLCIkKCdkb2N1bWVudCcpLnJlYWR5KGZ1bmN0aW9uKCl7XHJcbiAgICBmdW5jdGlvbiBhZGFwdGl2ZSgpe1xyXG4gICAgICAgIGlmKCQod2luZG93KS53aWR0aCgpIDwgOTkyKXtcclxuICAgICAgICAgICAgJCgnLmhlYWRlciAuY29udGFjdHNfX3Bob25lJykuYXBwZW5kVG8oJy5oZWFkZXItbGVmdCcpO1xyXG4gICAgICAgIH1lbHNlIGlmKCQod2luZG93KS53aWR0aCgpID4gOTkyKXtcclxuICAgICAgICAgICAgJCgnLmhlYWRlciAuY29udGFjdHNfX3Bob25lJykucHJlcGVuZFRvKCcuaGVhZGVyX19jb250YWN0cycpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgYWRhcHRpdmUoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGFkYXB0aXZlKCk7XHJcbn0pOyIsImNvbnN0IHRyaWdnZXJlZF9zZWxlY3QgPSAkKCcuYmxvY2ssIC5jYXJkX19idG4nKTtcclxubGV0IHRyaWdnZXJlZF9ibG9ja3MgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndHJpZ2dlcmVkX2Jsb2NrcycpID8gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndHJpZ2dlcmVkX2Jsb2NrcycpKSA6W107XHJcblxyXG50cmlnZ2VyZWRfc2VsZWN0LmNsaWNrKGZ1bmN0aW9uKCl7XHJcbiAgICBsZXQgdHJpZ2dlciA9ICQodGhpcyk7XHJcbiAgICBsZXQgYmxvY2tfaW5kZXggPSB0cmlnZ2VyLmRhdGEoJ3NsaWRlJyk7XHJcblxyXG4gICAgaWYoJC5pbkFycmF5KGJsb2NrX2luZGV4LCB0cmlnZ2VyZWRfYmxvY2tzKSA9PSAtMSl7XHJcbiAgICAgICAgdHJpZ2dlcmVkX2Jsb2Nrcy5wdXNoKGJsb2NrX2luZGV4KTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGlmKHRyaWdnZXIuaGFzQ2xhc3MoJ2Jsb2NrJykgPT0gZmFsc2UpIHJldHVybjtcclxuICAgICAgICB0cmlnZ2VyZWRfYmxvY2tzID0gJC5ncmVwKHRyaWdnZXJlZF9ibG9ja3MsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPSBibG9ja19pbmRleDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndHJpZ2dlcmVkX2Jsb2NrcycsIEpTT04uc3RyaW5naWZ5KHRyaWdnZXJlZF9ibG9ja3MpKTtcclxuICAgIGluaXRCbG9ja3MoJChgLmJsb2NrW2RhdGEtc2xpZGU9XCIke2Jsb2NrX2luZGV4fVwiXWApKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBpbml0QmxvY2tzKGRhdGEpe1xyXG4gICAgbGV0IGhhdmVkX2FyciA9IGRhdGEuZmlsdGVyKGZ1bmN0aW9uKGluZGV4LCBpdGVtKXtcclxuICAgICAgICBpZih0cmlnZ2VyZWRfYmxvY2tzLmluZGV4T2YoJChpdGVtKS5kYXRhKCdzbGlkZScpKSAhPSAtMSl7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgICAgIH1cclxuICAgIH0pLmVhY2goZnVuY3Rpb24oKXtcclxuICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHJcbiAgICAgICAgJCh0aGlzKS5maW5kKCcuYmxvY2tfX2ljb24gaW1nJykuYXR0cignc3JjJywgJCh0aGlzKS5maW5kKCcuYmxvY2tfX2ljb24gaW1nJykuYXR0cignc3JjJykucmVwbGFjZSgvXFwuL2csJ19hY3RpdmUuJykpO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIGxldCBjbGVhcl9hcnIgPSBkYXRhLmZpbHRlcihmdW5jdGlvbihpbmRleCwgaXRlbSl7XHJcbiAgICAgICAgaWYodHJpZ2dlcmVkX2Jsb2Nrcy5pbmRleE9mKCQoaXRlbSkuZGF0YSgnc2xpZGUnKSkgPT0gLTEpe1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbTtcclxuICAgICAgICB9XHJcbiAgICB9KS5lYWNoKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgJCh0aGlzKS5maW5kKCcuYmxvY2tfX2ljb24gaW1nJykuYXR0cignc3JjJywgJCh0aGlzKS5maW5kKCcuYmxvY2tfX2ljb24gaW1nJykuYXR0cignc3JjJykucmVwbGFjZSgvX2FjdGl2ZS9nLCAnJykpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnLnN1Ym1pdC1hcHBsaWNhdGlvbi1zZWxlY3RfX3RpdGxlID4gc3BhbicpLnRleHQoJCgnLmJsb2NrLmFjdGl2ZScpLmxlbmd0aCk7XHJcbn1cclxuXHJcblxyXG5cclxuaW5pdEJsb2NrcygkKCcuYmxvY2snKSk7IiwiXHJcbiQoJy5jYXJkJykuZWFjaChmdW5jdGlvbigpe1xyXG4gIGxldCBjYXJkX19pbWFnZXMgPSAkKHRoaXMpLmZpbmQoJy5nYWxsZXJ5X19pbWFnZSBpbWcnKTtcclxuICBsZXQgY2FyZF9faW1hZ2UgPSBjYXJkX19pbWFnZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKmNhcmRfX2ltYWdlcy5sZW5ndGgpXS5zcmM7XHJcbiAgJCh0aGlzKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnLCBgdXJsKFwiJHtjYXJkX19pbWFnZX1cIilgKTtcclxufSk7XHJcblxyXG5sZXQgaW1hZ2VzID0gJCgnLmdhbGxlcnlfX2ltYWdlJyk7XHJcblxyXG5pbWFnZXMubW91c2VvdmVyKGZ1bmN0aW9uKCl7XHJcbiAgbGV0IHRoaXNfaW1hZ2UgPSAkKHRoaXMpO1xyXG4gIGxldCB0aGlzX3NyYyA9ICQodGhpcykuZmluZCgnaW1nJykuYXR0cignc3JjJyk7XHJcbiAgXHJcbiAgdGhpc19pbWFnZS5wYXJlbnRzKCcuY2FyZCcpLmNzcygnYmFja2dyb3VuZC1pbWFnZScsIGB1cmwoXCIke3RoaXNfc3JjfVwiKWApO1xyXG59KTtcclxuIiwiZnVuY3Rpb24gcHJvZ3Jlc3NCYXIoKSB7XHJcbiAgICBsZXQgc2Nyb2xsUG9zID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xyXG4gICAgbGV0IFdpbmRvd0hlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKTtcclxuXHJcblxyXG4gICAgbGV0IHdpbkggPSAkKHdpbmRvdykuaGVpZ2h0KCk7XHJcbiAgICBsZXQgZG9jSCA9ICQoZG9jdW1lbnQpLmhlaWdodCgpO1xyXG5cclxuXHJcblxyXG4gICAgbGV0IGJhc2VYID0gZG9jSCAtIHdpbkg7XHJcblxyXG4gICAgbGV0IGEgPSAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpIC8gYmFzZVgpICogMTAwO1xyXG4gICAgbGV0IGIgPSAoJCgnLmhlYWRlcl9fY292ZXInKS5oZWlnaHQoKSAvIGJhc2VYKSAqIDEwMDtcclxuXHJcbiAgICBpZihhIDwgYil7XHJcbiAgICAgICAgbGV0IHNwZWVkID0gYSAqIDI7XHJcbiAgICAgICAgbGV0IG9mZnNldCA9ICgxMDAgLSBiKSArIGI7XHJcbiAgICAgICAgbGV0IG9wYWNpdHkgPSAob2Zmc2V0IC0gc3BlZWQpIC8gMTAwO1xyXG5cclxuXHJcbiAgICAgICAgaWYob3BhY2l0eSA+IDAuODUpIHJldHVybjtcclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAkKCcuaGVhZGVyX19jb3ZlcicpLmNzcygnb3BhY2l0eScsIG9wYWNpdHkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG59XHJcblxyXG5cclxuXHJcbiQod2luZG93KS5zY3JvbGwocHJvZ3Jlc3NCYXIpOyIsImZ1bmN0aW9uIHRocm90dGxlKGZ1bmMsIHNlY29uZHMsIG5hbWUpe1xyXG4gICAgbGV0IHRpbWVyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oYHRpbWUtJHtuYW1lfWApID8gbG9jYWxTdG9yYWdlLmdldEl0ZW0oYHRpbWUtJHtuYW1lfWApIDogdW5kZWZpbmVkO1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKC4uLmFyZ3Mpe1xyXG4gICAgICAgIGlmKHRpbWVyID09IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICAgIHRpbWVyID0gJC5ub3coKTtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYHRpbWUtJHtuYW1lfWAsIHRpbWVyKTtcclxuICAgICAgICAgICAgZnVuYyguLi5hcmdzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYoJC5ub3coKSAtIHRpbWVyID4gc2Vjb25kcyl7XHJcbiAgICAgICAgICAgIHRpbWVyID0gJC5ub3coKTtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYHRpbWUtJHtuYW1lfWAsIHRpbWVyKTtcclxuICAgICAgICAgICAgZnVuYyguLi5hcmdzKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgZ2V0QWxlcnRfZXJyb3IoYNCf0L7QtNC+0LbQtNC40YLQtSDQtdGJ0LUgJHsoc2Vjb25kcyAvIDEwMDAgLSAoJC5ub3coKSAtIHRpbWVyKSAvIDEwMDApLnRvRml4ZWQoMCl9INGB0LXQutGD0L3QtCFgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBnZXRBbGVydF9zdWNjKHRleHQpe1xyXG4gICAgU3dhbC5maXJlKHtcclxuICAgICAgICBwb3NpdGlvbjogJ3RvcC1lbmQnLFxyXG4gICAgICAgIGljb246ICdzdWNjZXNzJyxcclxuICAgICAgICB0aXRsZTogdGV4dCxcclxuICAgICAgICBwYWRkaW5nOiAnMmVtJyxcclxuXHJcbiAgICAgICAgd2lkdGg6ICcxMDAlJyxcclxuICAgICAgICBjb2xvcjogJyMyMzIxMjInLFxyXG4gICAgICAgIGJhY2tncm91bmQ6ICcjRUFFQUVBJyxcclxuXHJcbiAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLFxyXG4gICAgICAgIHRpbWVyOiAzNTAwLFxyXG5cclxuICAgICAgICB0b2FzdDogdHJ1ZSxcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEFsZXJ0X2Vycm9yKHRleHQpe1xyXG4gIFN3YWwuZmlyZSh7XHJcbiAgICAgIHBvc2l0aW9uOiAndG9wLWVuZCcsXHJcbiAgICAgIGljb246ICdlcnJvcicsXHJcbiAgICAgIHRpdGxlOiB0ZXh0LFxyXG4gICAgICBwYWRkaW5nOiAnMmVtJyxcclxuXHJcbiAgICAgIHdpZHRoOiAnMTAwJScsXHJcbiAgICAgIGNvbG9yOiAncmVkJyxcclxuICAgICAgYmFja2dyb3VuZDogJyNFQUVBRUEnLFxyXG5cclxuICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLFxyXG4gICAgICB0aW1lcjogMzUwMCxcclxuXHJcbiAgICAgIHRvYXN0OiB0cnVlLFxyXG4gIH0pXHJcbn1cclxuXHJcblxyXG4kKCdhW2hyZWZePVwiI1wiXScpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24odCkge1xyXG4gICAgdC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdmFyIGUsIG4gPSAkKHRoaXMuaGFzaCk7XHJcbiAgICBuLmxlbmd0aCAmJiAoZSA9ICQod2luZG93KS53aWR0aCgpIDwgNzY4ID8gMTIwIDogMjIwLCAkKFwiaHRtbCwgYm9keVwiKS5hbmltYXRlKHtcclxuICAgICAgICBzY3JvbGxUb3A6IG4ub2Zmc2V0KCkudG9wIC0gZVxyXG4gICAgfSwgNDAwKSlcclxufSksICQod2luZG93KS5vbihcInRvdWNobW92ZVwiLCBmdW5jdGlvbigpIHtcclxuICAgICQoJ2FbaHJlZl49XCIjXCJdJykuZGF0YShcImNsaWNrZWRcIiwgITEpXHJcbn0pLCAkKGRvY3VtZW50KS5vbihcInRvdWNoZW5kXCIsICdhW2hyZWZePVwiI1wiXScsIGZ1bmN0aW9uKHQpIHtcclxuICAgICQodGhpcykuZGF0YShcImNsaWNrZWRcIikgJiYgKHQucHJldmVudERlZmF1bHQoKSwgJCh0aGlzKS5kYXRhKFwiY2xpY2tlZFwiLCAhMSkpXHJcbn0pIiwiJChcIltkYXRhLWZhbmN5Ym94XVwiKS5mYW5jeWJveCh7XHJcbiAgICB0b3VjaDogZmFsc2VcclxufSk7IiwibGV0IG93bF9zZXJ2Y2llcyA9ICQoJy5vd2wtY2Fyb3VzZWwtLXNlcnZpY2VzJykub3dsQ2Fyb3VzZWwoe1xyXG4gICAgc2xpZGVTcGVlZDogMzAwLFxyXG4gICAgcGFnaW5hdGlvblNwZWVkOiA0MDAsXHJcbiAgICBjZW50ZXI6IHRydWUsXHJcbiAgICBzdG9wT25Ib3ZlcjogdHJ1ZSxcclxuICAgIGF1dG9wbGF5OiAxMDAsXHJcbiAgICBsb29wOiB0cnVlLFxyXG4gICAgbWFyZ2luOiA1MCxcclxufSk7XHJcblxyXG5cclxuXHJcbiQoJy5jYXJvdXNlbC1zZXJ2aWNlc19fbmV4dCcpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgb3dsX3NlcnZjaWVzLnRyaWdnZXIoJ25leHQub3dsLmNhcm91c2VsJywgWzMwMF0pO1xyXG59KVxyXG5cclxuJCgnLmNhcm91c2VsLXNlcnZpY2VzX19wcmV2JykuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICBvd2xfc2VydmNpZXMudHJpZ2dlcigncHJldi5vd2wuY2Fyb3VzZWwnLCBbMzAwXSk7XHJcbn0pXHJcblxyXG5cclxuXHJcblxyXG4kKCcuY2Fyb3VzZWwtc2VydmljZXMtZG90JykuY2xpY2soZnVuY3Rpb24oaW5kZXgsIGRvdCl7XHJcbiAgICBpZigkKCcuY2Fyb3VzZWwtc2VydmljZXMtZG90cycpLmhhc0NsYXNzKCdmaXhlZCcpKXtcclxuICAgICAgICAkKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7c2Nyb2xsVG9wOiAkKGAuY2FyZF9fYnRuW2RhdGEtc2xpZGU9JyR7JCh0aGlzKS5kYXRhKCdzbGlkZScpfSddYCkucGFyZW50cygnLmNhcmQnKS5vZmZzZXQoKS50b3B9LCAxMDAwKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5cclxuXHJcblxyXG4vKiBsZXQgb3dsX3N1Ym1pdF9hcHBsaWNhdGlvbiA9ICQoJy5vd2wtY2Fyb3VzZWwtLXN1Ym1pdC1hcHBsaWNhdGlvbicpLm93bENhcm91c2VsKHtcclxuICAgIHNsaWRlU3BlZWQ6IDMwMCxcclxuICAgIHBhZ2luYXRpb25TcGVlZDogNDAwLFxyXG4gICAgY2VudGVyOiB0cnVlLFxyXG4gICAgc3RvcE9uSG92ZXI6IHRydWUsXHJcbiAgICBpdGVtczogNCxcclxuICAgIGF1dG9wbGF5OiAxMDAsXHJcbiAgICBsb29wOiB0cnVlLFxyXG4gICAgbWFyZ2luOiAzMCxcclxufSk7XHJcblxyXG4gKi9cclxuXHJcblxyXG4iLCIkKCcuY2FyZF9fYnRuJykuY2xpY2soZnVuY3Rpb24oZSl7XHJcbiAgICBsZXQgY2FyZF9uYW1lID0gJCh0aGlzKS5zaWJsaW5ncygnLmNhcmRfX3RpdGxlJykudGV4dCgpO1xyXG5cclxuXHJcbiAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgIHNyYzogJy5zdWJtaXQtYXBwbGljYXRpb24nLFxyXG4gICAgICAgIHR5cGU6ICdpbmxpbmUnLFxyXG4gICAgICAgIHRvdWNoOiBmYWxzZSxcclxuLyogICAgICAgICBoZWlnaHQ6IDg3MCxcclxuICAgICAgICB3aWR0aDogNjAwLCAqL1xyXG4gICAgICAgIGF1dG9TaXplOiB0cnVlLFxyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuXHJcblxyXG5cclxuJCgnLnN1Ym1pdC1hcHBsaWNhdGlvbi1mb3JtJykudmFsaWRhdGUoe1xyXG4gICAgcnVsZXM6IHtcclxuICAgICAgICBwaG9uZToge1xyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBuYW1lOiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcbiAgICB9LFxyXG5cclxuICAgIG1lc3NhZ2VzOiB7XHJcbiAgICAgICAgcGhvbmU6IHtcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IFwi0JLQstC10LTQuNGC0LUg0L3QvtC80LXRgCDRgtC10LvQtdGE0L7QvdCwIVwiXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbmFtZToge1xyXG4gICAgICAgICAgICByZXF1aXJlZDogXCLQktCy0LXQtNC40YLQtSDQuNC80Y8hXCJcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICAgICAgc3VibWl0SGFuZGxlcjogZnVuY3Rpb24oZm9ybSkge1xyXG4gICAgICAgICAgICB0aHJvdHRsZShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgbGV0IGFjdGl2YXRlZF9pdGVtcyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgICQoJy5ibG9jay5hY3RpdmUgLmJsb2NrX190aXRsZScpLmVhY2goZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmF0ZWRfaXRlbXMucHVzaCgkKHRoaXMpLnRleHQoKSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9waHAvc3VibWl0LWFwcGxpY2F0aW9uLnBocCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Bvc3QnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmU6ICQoJy5zdWJtaXQtYXBwbGljYXRpb24tZm9ybSBpbnB1dFtuYW1lPVwicGhvbmVcIl0nKS52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJCgnLnN1Ym1pdC1hcHBsaWNhdGlvbi1mb3JtIGlucHV0W25hbWU9XCJuYW1lXCJdJykudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldmlldzogJCgnLnN1Ym1pdC1hcHBsaWNhdGlvbi1mb3JtIHRleHRhcmVhW25hbWU9XCJyZXZpZXdcIicpLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogSlNPTi5zdHJpbmdpZnkoYWN0aXZhdGVkX2l0ZW1zKSxcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QWxlcnRfc3VjYygn0JfQsNGP0LLQutCwINGD0YHQv9C10YjQvdC+INC+0YLQv9GA0LDQstC70LXQvdCwISDQntC20LjQtNCw0LnRgtC1INC+0YLQstC10YLQsCEnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTsgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSwgMTgwMDAwLCAnc3VibWl0LWFwcGxpY2F0aW9uJykoKTtcclxuICAgICAgICB9XHJcbn0pO1xyXG5cclxuXHJcbiQudmFsaWRhdG9yLmFkZE1ldGhvZChcInBob25lXCIsIGZ1bmN0aW9uKHZhbHVlLCBlbGVtZW50KSB7XHJcbiAgICByZXR1cm4gdGhpcy5vcHRpb25hbChlbGVtZW50KSB8fCAvXlxcKz9cXGR7MSw0fT9bLS5cXHNdP1xcKD9cXGR7MSwzfT9cXCk/Wy0uXFxzXT9cXGR7MSw0fVstLlxcc10/XFxkezEsNH1bLS5cXHNdP1xcZHsxLDl9JC8udGVzdCh2YWx1ZSk7XHJcbiAgICB9LCBcItCd0L7QvNC10YAg0LLQstC10LTQtdC9INC90LXQutC+0YDRgNC10LrRgtC90L4hXCIpOyIsInNhbCgpOyJdfQ==
